<p id="notice"><%= notice %></p>

<h1>スケジュール</h1>

<% today = Date.today %>
<% now = Date.current %>
<table border="1">
  <caption><%= now.strftime('%Y年%m月') %></caption>
  <tr height="50px">
    <th width="80px" style="background: red;"><spen style="color: white;">日</spen></th>
    <th width="80px" style="background: blue;"><spen style="color: white;">月</spen></th>
    <th width="80px" style="background: blue;"><spen style="color: white;">火</spen></th>
    <th width="80px" style="background: blue;"><spen style="color: white;">水</spen></th>
    <th width="80px" style="background: blue;"><spen style="color: white;">木</spen></th>
    <th width="80px" style="background: blue;"><spen style="color: white;">金</spen></th>
    <th width="80px" style="background: blue;"><spen style="color: white;">土</spen></th>
  </tr>
  <tr>
<% month = now.strftime('%m') %>
<% d = now.at_beginning_of_month.at_beginning_of_week(:sunday) %>
<% 1.upto(5).each do |i| %>
  <tr height="100px">
<% (d..d.end_of_week(:sunday)).each do |c| %>
  <td align="left" valign="top" style="background: <%= (c == today) ? "gray" : "white" %>;">
    <%= (c.strftime('%m') == month) ? c.strftime('%d') : " " %><br>
    <% @sches.each do |sche| %>
      <% if c.strftime('%y-%m-%d') == sche.schedule_at.strftime('%y-%m-%d') %>
       <%= sche.icon_id %>
      <% end %>
    <% end %>
    </td>
<% end %>
  </tr>
<% d = d + 1.week %>
<% end %>
</table>

<table>
  <thead>
    <tr>
      <th>日時</th>
      <th>予定名</th>
      <th>アイコン</th>
      <th>スヌーズ</th>
      <th>場所</th>
      <th>メモ</th>
      <th>アプリ内通知</th>
      <th>メール通知</th>
      <th>通知時間</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @sches.each do |sche| %>
      <tr>
        <td><%= sche.schedule_at %></td>
        <td><%= sche.name_sche %></td>
        <td><%= sche.icon_id %></td>
        <td><%= sche.snooze %></td>
        <td><%= sche.place %></td>
        <td><%= sche.memo_sche %></td>
        <td><%= sche.notification_sche %></td>
        <td><%= sche.mail_sche %></td>
        <td><%= sche.notification_time %></td>
        <td><%= link_to '詳細', sche %></td>
        <td><%= link_to '編集', edit_sch_path(sche) %></td>
        <td><%= link_to '削除', sche, method: :delete, data: { confirm: '削除しますか？' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to '新規スケジュール', new_sch_path %>
